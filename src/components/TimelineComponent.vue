<template>
  <div class="main-ws-sec">
    <div class="post-topbar">
      <textarea v-model="posts" name="post_area" id="post_area" class="form-control">何を考えていますか?</textarea>
      <div class="chose-image">
        <ul>
          <li>
            <label for="btn_chose_file" class="btn btn-danger" title="Chose file .png or .jpeg">画像を選択</label>
            <input @change="chooseImage" accept=".jpg, .jpeg, .png" type="file" class="btn btn-danger" name="chose-file"
              id="btn_chose_file" />
          </li>
        </ul>
      </div>
      <div class="post-st">
        <ul>
          <li>
            <a class="active" v-on:click="submit()" href="#" title="Submit post data">Submit</a>
          </li>
        </ul>
      </div>
      <!--post-st end-->
    </div>
    <!--post-topbar end-->
    <div class="posts-section">
      <div class="post-bar">
        <div class="post_topbar">
          <div class="usy-dt">
            <img src="../assets/images/resources/us-pic.png" alt="" />
            <div class="usy-name">
              <h3>Minh Chính Phạm</h3>
              <span><img src="../assets/images/clock.png" alt="" />05月07日</span>
            </div>
          </div>
          <div class="ed-opts">
            <a href="#" title="" class="ed-opts-open"><i class="fa fa-ellipsis-v"></i></a>
            <ul class="ed-options">
              <!-- My post has edit and delete -->
              <li><a href="#" title="">編集</a></li>
              <li><a href="#" title="">削除</a></li>
            </ul>
          </div>
        </div>
        <div class="epi-sec">
          <ul class="descp">
            <!-- Jobs -->
            <li>
              <img src="../assets/images/icon8.png" alt="" /><span>元首相</span>
            </li>
            <!-- Nationality -->
            <li>
              <img src="../assets/images/icon9.png" alt="" /><span>VietNam</span>
            </li>
          </ul>
          <ul class="bk-links">
            <!-- Add to bookmark -->
            <li>
              <a href="#" title=""><i class="fa fa-bookmark"></i></a>
            </li>
            <!-- Go to message page -->
            <li>
              <a href="messages.html" title=""><i class="fa fa-envelope"></i></a>
            </li>
          </ul>
        </div>
        <!-- Post description -->
        <div class="job_descp">
          <h3>共産党の上級政治局</h3>
          <ul class="job-dt">
            <li><a href="#" title="">フルタイム</a></li>
            <li><span>$30 / 時間</span></li>
          </ul>
          <p>
            中際提けトイつ売主ケキ膀認ねず務法債ぞろ惜禁け割門9要ワキ家際ほもば木久まき容純菜ぎぽぞ載動宅略石れざきこ。。。
            <a href="#" title="">もっと見る</a>
          </p>
        </div>
        <hr />
        <div class="skill-tags-area">
          <ul class="skill-tags">
            <li><a href="#" title="">経済学博士</a></li>
            <li><a href="#" title="">経済大臣</a></li>
            <li><a href="#" title="">首相</a></li>
          </ul>
        </div>
        <!-- End description -->
        <div class="job-status-bar">
          <ul class="like-com">
            <li>
              <a class="color-b2b2b2 cusror-poiter hover-color"><i class="fa fa-heart"></i> いいね (25)</a>
            </li>
            <li>
              <a class="color-b2b2b2 cusror-poiter hover-color"><i class="fa fa-comment-alt"></i> コメント (15)</a>
            </li>
          </ul>
          <a><i class="fa fa-eye"></i>閲覧数 (50)</a>
        </div>
      </div>
      <!--post-bar end-->
      <!-- Begin a post -->
      <div class="post-bar">
        <div class="post_topbar">
          <div class="usy-dt">
            <img src="../assets/images/resources/us-pic.png" alt="" />
            <div class="usy-name">
              <h3>Phúc Nguyễn Xuân</h3>
              <span><img src="../assets/images/clock.png" alt="" />05月06日</span>
            </div>
          </div>
          <div class="ed-opts">
            <a href="#" title="" class="ed-opts-open"><i class="fa fa-ellipsis-v"></i></a>
            <ul class="ed-options">
              <li><a href="#" title="">編集</a></li>
              <li><a href="#" title="">削除</a></li>
            </ul>
          </div>
        </div>
        <div class="epi-sec">
          <ul class="descp">
            <li>
              <img src="../assets/images/icon8.png" alt="" /><span>元大統領</span>
            </li>
            <li>
              <img src="../assets/images/icon9.png" alt="" /><span>VietNam</span>
            </li>
          </ul>
          <ul class="bk-links">
            <li>
              <a href="#" title=""><i class="fa fa-bookmark"></i></a>
            </li>
            <li>
              <a href="#" title=""><i class="fa fa-envelope"></i></a>
            </li>
          </ul>
        </div>
        <div class="job_descp">
          <h3>共産党の上級政治局</h3>
          <ul class="job-dt">
            <li><a href="#" title="">フルタイム</a></li>
            <li><span>$30 / 時間</span></li>
          </ul>
          <p>
            中際提けトイつ売主ケキ膀認ねず務法債ぞろ惜禁け割門9要ワキ家際ほもば木久まき容純菜ぎぽぞ載動宅略石れざきこ。合そいやぶ間準ヌイヘミ罪高そ県1人スヲナ月7神いこ港彬ホヨアタ最非3争ミイホヘ生要きゅ熱覧ょ式司フホメ究真メスチコ革面じ訓準晶ぼフを。足リみぴ術並ちときか強官リ氷任ノヤ帳済ユコニ専氏ヌレトム登様どにだ主産ノハミ出講ヲレヤ点本レ死海さッぴ属被骨け歳乗歌規なそご。。。
            <a href="#" title="">もっと見る</a>
          </p>
          <ul class="skill-tags">
            <li><a href="#" title="">元首相</a></li>
            <li><a href="#" title="">大統領</a></li>
          </ul>
        </div>
        <div class="job-status-bar">
          <ul class="like-com">
            <li>
              <a class="color-b2b2b2 cusror-poiter hover-color"><i class="fa fa-heart"></i> いいね (25)</a>
            </li>
            <li>
              <a class="color-b2b2b2 cusror-poiter hover-color"><i class="fa fa-comment-alt"></i> コメント (15)</a>
            </li>
          </ul>
          <a href="#"><i class="fas fa-eye"></i>閲覧数 (50)</a>
        </div>
      </div>
      <!--post-bar end-->
      <div class="posty">
        <div class="post-bar no-margin">
          <div class="post_topbar">
            <div class="usy-dt">
              <img src="../assets/images/resources/us-pc2.png" alt="" />
              <div class="usy-name">
                <h3>Trần Dần</h3>
                <span><img src="../assets/images/clock.png" alt="" />3 min
                  ago</span>
              </div>
            </div>
            <div class="ed-opts">
              <!-- Not my own post here none -->
            </div>
          </div>
          <div class="epi-sec">
            <ul class="descp">
              <li>
                <img src="../assets/images/icon8.png" alt="" /><span>宇宙予言</span>
              </li>
              <li>
                <img src="../assets/images/icon9.png" alt="" /><span>India</span>
              </li>
            </ul>
            <ul class="bk-links">
              <li>
                <a href="#" title=""><i class="fa fa-bookmark"></i></a>
              </li>
              <li>
                <a href="#" title=""><i class="fa fa-envelope"></i></a>
              </li>
            </ul>
          </div>
          <div class="job_descp">
            <h3>アメリカ共和党顧問</h3>
            <ul class="job-dt">
              <li><a href="#" title="">フルタイム</a></li>
              <li><span>$30 / 時間</span></li>
            </ul>
            <p>
              主ケキ膀認ねず務法債中際提けトイつ売ぞろ惜禁け割門9要ワキ家際ほもば木久まき容純菜ぎぽぞ載動宅略石れざきこ。。。
              <a href="#" title="">もっと見る</a>
            </p>
            <ul class="skill-tags">
              <li><a href="#" title="">アメリカ共和党顧問</a></li>
              <li>
                <a href="#" title="">ベトナム共産党スパイ</a>
              </li>
            </ul>
          </div>
          <div class="job-status-bar">
            <ul class="like-com">
              <li>
                <a class="color-b2b2b2 cusror-poiter hover-color"><i class="fa fa-heart"></i> いいね (25)</a>
              </li>
              <li>
                <a class="color-b2b2b2 cusror-poiter hover-color"><i class="fa fa-comment-alt"></i> コメント (15)</a>
              </li>
            </ul>
            <a href="#"><i class="fa fa-eye"></i>閲覧数 (50)</a>
          </div>
        </div>
        <!--post-bar end-->
        <div class="comment-section">
          <div class="comment-sec">
            <ul>
              <li>
                <div class="comment-list">
                  <div class="bg-img">
                    <img class="ava-cmt" src="../assets/images/resources/us-pc2.png" alt="" />
                  </div>
                  <div class="comment">
                    <h3>Minh Chính Phạm</h3>
                    <span><img src="../assets/images/clock.png" alt="" />
                      05月06日</span>
                    <p>中際提けトイつ売</p>
                    <a href="#" title="" class="active"><i class="fa fa-reply-all"></i>返信</a>
                  </div>
                </div>
                <!--comment-list end-->
                <!-- Reply begin -->
                <ul>
                  <li>
                    <div class="comment-list">
                      <div class="bg-img">
                        <img src="../assets/images/resources/bg-img2.png" alt="" />
                      </div>
                      <div class="comment">
                        <h3>Phúc Nguyễn Xuân</h3>
                        <span><img src="../assets/images/clock.png" alt="" />
                          05月06日</span>
                        <p>
                          中際提けトイつ売主ケキ膀認ねず務法債ぞろ惜禁け割門9要
                        </p>
                        <a href="#" title=""><i class="fa fa-reply-all"></i>返信</a>
                      </div>
                    </div>
                    <!--comment-list end-->
                  </li>
                </ul>
                <!-- End reply -->
              </li>
              <li>
                <div class="comment-list">
                  <div class="bg-img">
                    <img src="../assets/images/resources/bg-img3.png" alt="" />
                  </div>
                  <div class="comment">
                    <h3>Trần Dần</h3>
                    <span><img src="../assets/images/clock.png" alt="" />
                      05月06日</span>
                    <p>中際提けトイつ売</p>
                    <p>
                      ず務法債中際提けトイつ売ぞろ惜禁け割門9要ワ
                      <i class="fa fa-heart"></i>
                    </p>
                    <a href="#" title=""><i class="fa fa-reply-all"></i>返信</a>
                  </div>
                </div>
                <!--comment-list end-->
              </li>
            </ul>
          </div>
          <!--comment-sec end-->
          <div class="post-comment">
            <div class="comment_box">
              <form>
                <input type="text" placeholder="コメント #タグ を入力" />
                <button type="submit">
                  <i class="fa fa-paper-plane"></i>
                </button>
              </form>
            </div>
          </div>
          <!--post-comment end-->
        </div>
        <!--comment-section end-->
      </div>
      <!--posty end-->
      <div class="process-comm">
        <div class="spinner">
          <div class="bounce1"></div>
          <div class="bounce2"></div>
          <div class="bounce3"></div>
        </div>
      </div>
      <!--process-comm end-->
    </div>
    <!--posts-section end-->
  </div>
</template>

<script>
// import Vue from 'vue'
import axios from "axios";

// import component1 from 'component1'
// import component2 from 'component2'

// bat dau phan than cua chuong trinh vuejs
export default {
  /***********************************************************************************************************
   ******************************* Pass data to child component **********************************************
   **********************************************************************************************************/
  // props: [variable1, variable2],
  // components: {component1, component2},
  data() {
    /***********************************************************************************************************
     ******************************* Initialize global variables ***********************************************
     **********************************************************************************************************/
    return {
      msg: "Hello world!",
      users: [],
      posts: "",
      postImage: null,
      token: sessionStorage.getItem("token"),
    };
  },
  created() {
    /***********************************************************************************************************
     *********************** Initialize data when this component is used. **************************************
     **********************************************************************************************************/
    console.log(
      "Init created component and call to function get data from api server."
    );
    // this.callAPI();
  },
  mounted() {
    /***********************************************************************************************************
     ******************** Once created, the interface is displayed and calls mounted. **************************
     **********************************************************************************************************/
  },
  watch: {
    /***********************************************************************************************************
     ********************************* Methods change value for a variable *************************************
     **********************************************************************************************************/
    msg() {
      console.log(
        "When the value of the msg variable changes, this method will be executed."
      );
    },
  },
  computed: {
    appendMsg() {
      return (
        msg +
        "Process the value and assign the value to the corresponding variable the var has changed."
      );
    },
  },
  methods: {
    /***********************************************************************************************************
     ******************************* Default functions that handle local data **********************************
     **********************************************************************************************************/

    /**
     * Example default function not using param
     */
    defaultFunction() {
      this.msg = "Replace message here!";
    },

    chooseImage(event) {
      let file = event.target.files[0];
      // console.log(file);
      if (file.type != 'image/jpeg' && file.type != 'image/png') {
        alert("Wrong image format.");
        return null;
      }
      if (file.size > 2048000) {
        alert("Only image smaller than 2MB allowed.")
        return null;
      }

      this.postImage = file;
    },

    async submit() {
      if (this.posts == '' || this.posts == null) {
        alert("Post content is empty.");
        return null;
      }

      let formData = new FormData();
      formData.append('content', this.posts);
      formData.append('image', this.postImage);
      // Send to server
      try {
        const callAPI = await axios.post(
          "http://localhost/wisesocial_api/public/api/create-post",
          formData, {
          headers: {
            "Content-Type": "multipart/form-data",
            Authorization: "Bearer " + this.token,
          }
        }
        );
        if (callAPI.data.code == 200) {
          this.suggestFriend = callAPI.data.data;
          // TODO reload all posts
          return null;
        } else {
          alert("Call API failed, please check again!");
        }
        console.log(callAPI.data);
      } catch (err) {
        console.log(err);
      }

      // console.log(this.postImage);
      // console.log(this.posts);
    },

    /**
     * Example default function using param
     *
     * @param int pageNum number of page
     * @return boolean
     */
    defaultFunctionUsingParam(pageNum) {
      console.log(pageNum);
      return false;
    },

    /***********************************************************************************************************
     ******* Async and await functions for manipulating server-side data through internal API protocols ********
     **********************************************************************************************************/

    // /**
    //  * Call API sample
    //  */
    // async callAPI() {
    //   try {
    //     const callAPI = await axios.get(
    //       "http://localhost/wisesocial_api/public/api/list-user",
    //       {
    //         headers: {
    //           "Content-Type": "application/json",
    //           Authorization: "Bearer " + this.token,
    //         },
    //       }
    //     );
    //     if (callAPI.data.code == 200) {
    //       this.users = callAPI.data.data;
    //     } else {
    //       alert("Call API failed, please check again!");
    //     }
    //     console.log(callAPI.data);
    //   } catch (err) {
    //     console.log(err);
    //   }
    // },

    // async deleteUser(id) {
    //   try {
    //     const callAPI = await axios.delete(
    //       "http://localhost/DemoAPI/public/api/delete-user/" + id,
    //       {
    //         headers: {
    //           "Content-Type": "application/json",
    //           Authorization: "Bearer " + this.token,
    //         },
    //       }
    //     );
    //     this.callAPI();
    //   } catch (err) {
    //     console.log(err);
    //   }
    // },
  },
};
</script>

<style>
/**
* Custom local style css
*/
</style>
